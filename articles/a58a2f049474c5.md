---
title: "ãƒã‚¹ãƒˆã—ãŸé…åˆ—å†…ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å€¤ã§é…åˆ—ã‚’ä¸¦ã³æ›¿ãˆã‚‹"
emoji: "ğŸ‘©â€ğŸ‘§â€ğŸ‘¦"
type: "tech"
topics: ['javascript']
published: true
---

å®Ÿè£…æ™‚ã€èª¿ã¹ã‚‹ã®ã«æ™‚é–“ãŒã‹ã‹ã£ãŸã®ã§ãƒ¡ãƒ¢ã§ã™ã€‚

```js
[
  {
    "id": 1,
    "state": {
      "displayOrder": 0
    },
  },
  {
    "id": 2,
    "state": {
      "displayOrder": -1
    },
    "child": [
      {
        "id": 6,
        "state": {
          "displayOrder": 1
        }
      },
      {
        "id":7,
        "state": {
          "displayOrder": 0
        }
      },
    ]
  },
  {
    "id": 3,
    "state": {
      "displayOrder": 1
    },
    "child": [
      {
        "id": 8,
        "state": {
          "displayOrder": 1
        }
      },
      {
        "id": 9,
        "state": {
          "displayOrder": null
        }
      },
      {
        "id": 10,
        "state": {
          "displayOrder": 0
        }
      },
    ]
  },
  {
    "id": 4,
    "state": {
      "displayOrder": null
    },
  },
  {
    "id": 5,
    "state": {
      "displayOrder": 2
    },
  },
]
```

ä¸Šè¨˜ã®ã‚ˆã†ãªé…åˆ—ã‚’`displayOrder`ã®å€¤ã§æ˜‡é †ã«ä¸¦ã³æ›¿ãˆã‚‹ã€‚ãŸã ã—`displayOrder`ãŒnullï¼ˆã‚ã‚‹ã„ã¯ç©ºå€¤ã‚„undefindã€falseï¼‰ã ã£ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯æœ€å¾Œå°¾ã«ã¤ã‘ã‚‹ã€‚

ä»¥ä¸‹ã®ã‚ˆã†ã«`child`ä»¥ä¸‹ã‚‚åŒæ§˜ã«å‡¦ç†ã™ã‚‹ã€‚

```js
[
  {
    "id": 2,
    "state": {
      "displayOrder": -1
    },
    "child": [
      {
        "id": 7,
        "state": {
          "displayOrder": 0
        }
      },
      {
        "id": 6,
        "state": {
          "displayOrder": 1
        }
      }
    ]
  },
  {
    "id": 1,
    "state": {
      "displayOrder": 0
    }
  },
  {
    "id": 3,
    "state": {
      "displayOrder": 1
    },
    "child": [
      {
        "id": 10,
        "state": {
          "displayOrder": 0
        }
      },
      {
        "id": 8,
        "state": {
          "displayOrder": 1
        }
      },
      {
        "id": 9,
        "state": {
          "displayOrder": null
        }
      },
    ]
  },
  {
    "id": 5,
    "state": {
      "displayOrder": 2
    }
  },
  {
    "id": 4,
    "state": {
      "displayOrder": null
    }
  }
]
```

# `sort()`ã¨`Number.isFinite()`ã§ä¸¦ã³æ›¿ãˆã‚‹

æ•°å­—ã®ä¸¦ã³é †ã‚’å¤‰æ›´ã™ã‚‹ã®ã«`sort()`ã‚’ä½¿ç”¨ã—ã€å€¤ãŒnullï¼ˆã‚ã‚‹ã„ã¯ç©ºå€¤ã‚„undefindã€falseï¼‰ã‹ã©ã†ã‹ã®åˆ¤å®šã«`Number.isFinite()`ã‚’ä½¿ç”¨ã—ãŸé–¢æ•°ã‚’ä½œã‚‹ã€‚

https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Array/sort

ã¡ãªã¿ã«`Number.isFinite()`ã¯ã€å³å¯†ã«ã¯å€¤ãŒæœ‰é™æ•°ã§ã‚ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤æ–­ã™ã‚‹ã‚‚ã®ã§ã™ã€‚æœ‰é™æ•°ã§ã‚ã‚Œã°`true`ã‚’ã€ãã†ã§ãªã‘ã‚Œã°`false`ã‚’è¿”ã—ã¾ã™ã€‚

https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Number/isFinite

`displayOrder`ã®å€¤ãŒæ•°å€¤ã§ã‚ã‚Œã°æ¯”è¼ƒã—ã¦æ˜‡é †ã«ã€ãã†ã§ãªã‘ã‚Œã°å¾Œã‚ã«ã‚½ãƒ¼ãƒˆã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

```js
const orderSort = (array) => array.sort((a, b) => {
  const aOrder = a.state.displayOrder
  const bOrder = b.state.displayOrder

  return !Number.isFinite(aOrder) ? 1 : !Number.isFinite(bOrder) ? -1 : aOrder === bOrder ? 0 : aOrder - bOrder;
})
```

# ã¾ãšè¦ªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰ä¸¦ã³æ›¿ãˆã‚‹

```js
const array = [
  {
    "id": 1,
    "state": {
      "displayOrder": 0
    },
  },
  {
    "id": 2,
    "state": {
      "displayOrder": -1
    },
    "child": [...]
  },
  {
    "id": 3,
    "state": {
      "displayOrder": 1
    },
    "child": [...]
  },
  {
    "id": 4,
    "state": {
      "displayOrder": null
    },
  },
  {
    "id": 5,
    "state": {
      "displayOrder": 2
    },
  },
]

const sortArray = orderSort(array)

console.log(sortArray)
/* [
  {
    "id": 2,
    "state": {
      "displayOrder": -1
    },
    "child": [...]
  },
  {
    "id": 1,
    "state": {
      "displayOrder": 0
    }
  },
  {
    "id": 3,
    "state": {
      "displayOrder": 1
    },
    "child": [...]
  },
  {
    "id": 5,
    "state": {
      "displayOrder": 2
    }
  },
  {
    "id": 4,
    "state": {
      "displayOrder": null
    }
  }
] */
```

# `in`æ¼”ç®—å­ã§ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®æœ‰ç„¡ã‚’ç¢ºèªã—ã¦ã‹ã‚‰`child`ä»¥ä¸‹ã‚’ä¸¦ã³æ›¿ãˆã‚‹

`child`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æŒãŸãªã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚‚ã‚ã‚‹ã®ã§`in`æ¼”ç®—å­ã§æœ‰ç„¡ã‚’ç¢ºèªã™ã‚‹ã€‚

https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Operators/in

```js
sortArray.map((item) => 'child' in item && orderSort(item.child))

console.log(sortArray)
/*
[
  {
    ...,
    "child": [
      {
        "id": 7,
        "state": {
          "displayOrder": 0
        }
      },
      {
        "id": 6,
        "state": {
          "displayOrder": 1
        }
      }
    ]
  },
  ...,
  {
    ...,
    "child": [
      {
        "id": 10,
        "state": {
          "displayOrder": 0
        }
      },
      {
        "id": 8,
        "state": {
          "displayOrder": 1
        }
      }
      {
        "id": 9,
        "state": {
          "displayOrder": null
        }
      },
    ]
  },
  ...,
  ...
]
*/
```

æ–°ã—ã„é…åˆ—ã‚’ä½œã‚‹ã‚ã‘ã§ã¯ãªã„ã®ã§`map()`ã§ã¯ãªã`forEach()`ã§ã‚‚åŒã˜çµæœã«ãªã‚‹ã€‚

```js
sortArray.forEach((item) => 'child' in item && orderSort(item.child))
```

# ã¾ã¨ã‚ã¦æ›¸ã„ã¦ã¿ã‚‹

```js
const array = [
  {
    "id": 1,
    "state": {
      "displayOrder": 0
    },
  },
  {
    "id": 2,
    "state": {
      "displayOrder": -1
    },
    "child": [
      {
        "id": 6,
        "state": {
          "displayOrder": 1
        }
      },
      {
        "id":7,
        "state": {
          "displayOrder": 0
        }
      },
    ]
  },
  {
    "id": 3,
    "state": {
      "displayOrder": 1
    },
    "child": [
      {
        "id": 8,
        "state": {
          "displayOrder": 1
        }
      },
      {
        "id": 9,
        "state": {
          "displayOrder": null
        }
      },
      {
        "id": 10,
        "state": {
          "displayOrder": 0
        }
      },
    ]
  },
  {
    "id": 4,
    "state": {
      "displayOrder": null
    },
  },
  {
    "id": 5,
    "state": {
      "displayOrder": 2
    },
  },
]

const orderSort = (array) => array.sort((a, b) => {
  const aOrder = a.state.displayOrder
  const bOrder = b.state.displayOrder

  return !Number.isFinite(aOrder) ? 1 : !Number.isFinite(bOrder) ? -1 : aOrder === bOrder ? 0 : aOrder - bOrder;
})

orderSort(array).map((item) => 'child' in item && orderSort(item.child))

console.log(array)
/*
[
  {
    "id": 2,
    "state": {
      "displayOrder": -1
    },
    "child": [
      {
        "id": 7,
        "state": {
          "displayOrder": 0
        }
      },
      {
        "id": 6,
        "state": {
          "displayOrder": 1
        }
      }
    ]
  },
  {
    "id": 1,
    "state": {
      "displayOrder": 0
    }
  },
  {
    "id": 3,
    "state": {
      "displayOrder": 1
    },
    "child": [
      {
        "id": 10,
        "state": {
          "displayOrder": 0
        }
      },
      {
        "id": 8,
        "state": {
          "displayOrder": 1
        }
      }
      {
        "id": 9,
        "state": {
          "displayOrder": null
        }
      },
    ]
  },
  {
    "id": 5,
    "state": {
      "displayOrder": 2
    }
  },
  {
    "id": 4,
    "state": {
      "displayOrder": null
    }
  }
]
*/
```

ä»¥ä¸Šã§ã™ã€‚

ãƒã‚¹ãƒˆã•ã‚ŒãŸé…åˆ—ã®æ“ä½œã¯ã€ã‹ãªã‚ŠÃ¥ã‚„ã‚„ã“ã—ã„å°è±¡ã§ã™ã€‚ã‚‚ã£ã¨ä»–ã«ã‚¹ãƒãƒ¼ãƒˆãªæ–¹æ³•ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
